# CLL_GRN_paper

Welcome to the **CLL_GRN_paper** repository. This project contains the full code, data and analysis scripts supporting our manuscript:

📄 **Time-series RNA-Seq and data-driven network inference unveil dynamic cell phenotypes in Chronic Lymphocytic Leukaemia**

This comprehensive resource is designed for reproducibility and transparency in our research, providing a step-by-step account of our workflow from raw data processing to network inference and figure generation.

---

## 📑 Table of contents

- 📌 [Overview](#overview)
- 🎯 [Motivation and background](#motivation-and-background)
- 📂 [Repository structure](#repository-structure)
- 📊 [Data description](#data-description)
- ⚙️ [Installation and dependencies](#installation-and-dependencies)
- 🚀 [Usage instructions](#usage-instructions)
- 🤝 [Contribution guidelines](#contribution-guidelines)
- 📝 [Citation](#citation)
- ❓ [Troubleshooting and FAQ](#troubleshooting-and-faq)
- 📜 [License](#license)
- 📧 [Contact](#contact)

---

## 📌 Overview

Our research integrates **time-series RNA sequencing** with **data-driven gene regulatory network (GRN) inference** to elucidate the dynamic cell phenotypes in **Chronic Lymphocytic Leukaemia (CLL)** within a simulated **tumour microenvironment (TME)**. We compare **monoculture and autologous culture conditions** over five time points using an **in vitro model based on patient-derived CLL and immune cells**. Our goal is to reveal how immune interactions drive significant changes in gene expression, leading to the identification of critical regulatory pathways and culture/patient specific network dynamics.

---

## 🎯 Motivation and background

Cancer is a complex disease influenced by a multitude of factors, including the interplay between cancer cells and their surrounding immune cells. In CLL, the interaction with immune cells can rewire gene regulatory networks and alter cellular phenotypes, affecting disease progression. This repository documents our comprehensive approach:

- **Time series analysis:** Capturing dynamic changes over five time points (14 days).
- **GRN inference:** Employing data-driven algorithms based on transcription factor activity.
- **Patient specificity:** Emphasizing the role of patient heterogeneity in regulatory mechanisms.
- **Network analysis:** Dissecting gene modules related to biological processes such as immune response.

Our workflow offers a **reproducible blueprint** for similar studies in **oncology** and **systems biology**.

---

## 📂 Repository structure

### Data
- **Raw_data/** → Contains original RNA-Seq files (e.g., count matrices) and list of human TFs.
- **Processed_data/** → Includes normalized (TPM) datasets.
- **Metadata/** → Detailed experimental design and time point information.

### Figures
This repository contains only the final figures used in the paper. It includes high-quality, publication-ready plots such as PCA, heatmaps, networks, and time-series visualizations. No intermediate or exploratory plots are provided.

### Results  

The **Results** directory contains the processed outputs from various computational analyses conducted in this project. Each subfolder corresponds to a specific analytical method and is directly associated with the script(s) responsible for generating the results, ensuring full reproducibility. Below is the structured mapping of results to their corresponding scripts:  

1️⃣ **Normalized data** (`Normalized_data/`)  
   - Generated by: `Data_processing.R` and `Data_processing.Rmd`  

2️⃣ **VIPER analysis** (`VIPER/`)  
   - Generated by: `Viper.R` and `Viper.Rmd`  

3️⃣ **Gene Set Variation Analysis (GSVA)** (`GSVA/`)  
   - Generated by: `GSVA.Rmd`  

4️⃣ **Independent Component Analysis (ICA)** (`ICA/`)  
   - Generated by: `Biodica.R` and `Biodica.Rmd`  

5️⃣ **msVIPER analysis** (`msVIPER/`)  
   - Generated by: `msVIPER.R` and `msVIPER.Rmd`  

Each script implements a computational method to process the RNA-Seq dataset, contributing to downstream analyses and biological interpretation. This structured organization ensures clarity and reproducibility in the workflow.

### Scripts  

The **Script** directory contains all analysis scripts required to process the RNA-Seq data and generate the results. Each script is designed for a specific step in the computational pipeline, ensuring full traceability of the analyses. Below is an overview of the scripts and their respective functions:  

1️⃣ **Data processing** (`Data_processing.R` and `Data_processing.Rmd`)  
   - Performs raw data normalization and pre-processing steps.  
   - Outputs stored in the `Results/Normalized_data/` folder. 

2️⃣ **VIPER analysis** (`Viper.R` and `Viper.Rmd`)
   - Implements the VIPER algorithm to infer protein activity from gene expression data.  
   - Outputs stored in the `Results/VIPER/` folder.  

3️⃣ **Gene Set Variation Analysis (GSVA)** (`GSVA.Rmd`)  
   - Conducts GSVA to assess pathway enrichment across samples.  
   - Outputs stored in the `Results/GSVA/` folder.  

4️⃣ **Independent Component Analysis (ICA)** (`Biodica.R` and `Biodica.Rmd`)  
   - Applies ICA for dimensionality reduction and identification of independent gene expression components.  
   - Outputs stored in the `Results/ICA/` folder.  

5️⃣ **msVIPER analysis** (`msVIPER.R` and `msVIPER.Rmd`)  
   - Extends VIPER analysis to a meta-analysis framework for network-based interpretation.  
   - Outputs stored in the `Results/msVIPER/` folder.

Each script is written in **R** or **RMarkdown** (`.Rmd`) format, allowing for both interactive execution and script-based automation.

---

## 📊 Data description

In progress...

---

## ⚙️ Installation and dependencies

This project requires **R 4.4.2** (or later) on **Ubuntu 24.04.2 LTS**. The analysis relies on **Bioconductor** and **CRAN** packages for data processing, network inference, and visualization.

### Prerequisites
- **Operating system:** Ubuntu 24.04.2 LTS (or equivalent Linux-based system)
- **R Version:** 4.4.2 (2024-10-31)

### Session information

For a complete list of dependencies and system details, refer to the session information file:

📄 `sessionInfo.txt` (located in the project root)

### Environment management with renv

To ensure reproducibility, the project uses renv for dependency management.
Restore the project environment:
```bash
renv::restore()
```

This ensures a fully reproducible and stable environment for the analysis workflow.

---

## 🚀 Usage instructions

### Running the complete pipeline

The analysis workflow encompasses multiple stages, including data preprocessing, network inference, and other analyses. Each analysis is conducted using RMarkdown (.Rmd) scripts. To execute any stage, **open and knit** the corresponding .Rmd file in the `Script` directory. These scripts handle various tasks and outputs from each stage are **systematically stored in the corresponding results directories**, facilitating structured data interpretation and manuscript preparation.

Note: Each R Markdown file contains detailed instructions and explanations for its respective section of the analysis.

### Running individual modules

- Interactive sessions:
You can also run individual R scripts interactively in RStudio for step-by-step analysis.

- Configuration files:
Some scripts may refer to configuration settings; please modify these directly in the R Markdown files as needed.

---

## 🤝 Contribution guidelines

Contributions are welcomed! To contribute:

🔹 Fork the repository.

🔹 Create a feature branch (`git checkout -b feature/your-feature`).

🔹 Commit your changes with descriptive messages.

🔹 Push to your branch (`git push origin feature/your-feature`).

🔹 Open a pull request describing your changes.

Follow coding conventions & include documentation updates!

---

## 📝 Citation

Coming soon...

---

## ❓ Troubleshooting and FAQ

### Common issues

- **Package installation errors?** Ensure that you are using **R version 4.4.2.** For a reproducible environment, use `renv::restore()` to install the correct package versions, or refer to `sessionInfo.txt` to verify library versions.

- **Data format errors?** Verify that your raw data and metadata files are formatted correctly and match the expected inputs in the R Markdown files.

- **Knit failures?** Review the error messages when knitting R Markdown files. Often, missing packages or syntax errors in the code chunks are the cause.

### FAQ

- Q: **How do I update the GRN inference parameters?**
- A: Modify the parameter section in `Script/Run_dynGENIE3.Rmd` as needed, then re-knit the document.

- Q: **Can this pipeline be adapted for other datasets?**
- A: Yes. The R scripts and R Markdown files are modular and can be adapted for similar RNA-Seq and network analysis projects.

---

## 📜 License

This project is licensed under the [MIT LICENSE](LICENSE). Please refer to the [LICENSE](LICENSE) file for additional details.

---

## 📧 Contact

For questions, suggestions, or collaboration opportunities, please contact:

- **Hugo Chenel** – hugo.chenel@inserm.fr
- **Malvina Marku** – malvina.marku@inserm.fr
- **Vera Pancaldi** – vera.pancaldi@inserm.fr


Maintained by the NetB(IO)² research team at CRCT, Toulouse.